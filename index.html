<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>MovieStream · user panel</title>
  <!-- Font Awesome 6 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    /* ---------- CINEMATIC DARK THEME (unchanged, premium) ---------- */
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif; }
    body { background-color: #0b0b0b; color: #f5f5f5; padding-bottom: 80px; min-height: 100vh; line-height: 1.5; -webkit-font-smoothing: antialiased; }
    .screen { display: none; padding: 16px 16px 24px; animation: fadeTransition 0.25s ease; }
    .screen.active { display: block; }
    @keyframes fadeTransition { 0% { opacity: 0.6; } 100% { opacity: 1; } }
    h1, h2, h3, h4 { font-weight: 500; letter-spacing: -0.01em; }
    .text-muted { color: #a0a0a0; font-size: 0.9rem; }
    .app-header { display: flex; justify-content: space-between; align-items: center; padding: 12px 0 8px; margin-bottom: 6px; }
    .logo { font-size: 1.8rem; font-weight: 700; color: #e50914; letter-spacing: -0.5px; }
    .icon-btn { background: transparent; border: none; color: white; font-size: 1.3rem; padding: 8px; border-radius: 50%; transition: background 0.15s; }
    .icon-btn:active { background: rgba(255,255,255,0.1); }
    .banner-container { margin: 8px 0 20px; border-radius: 12px; overflow: hidden; }
    .banner-placeholder { width: 100%; aspect-ratio: 16/9; background: #1e1e1e; border-radius: 12px; display: flex; align-items: center; justify-content: center; color: #6a6a6a; font-size: 1rem; border: 1px solid #2a2a2a; box-shadow: 0 8px 12px rgba(0,0,0,0.6); }
    .dot-indicator { display: flex; justify-content: center; gap: 8px; margin-top: 12px; }
    .dot { width: 8px; height: 8px; border-radius: 4px; background: #404040; transition: all 0.2s; }
    .dot.active-dot { background: #e50914; width: 20px; }
    .row-section { margin-bottom: 28px; }
    .row-header { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 12px; }
    .row-title { font-size: 1.2rem; font-weight: 600; color: #f0f0f0; }
    .scroll-row { display: flex; gap: 12px; overflow-x: auto; overflow-y: hidden; padding-bottom: 8px; scrollbar-width: thin; scrollbar-color: #505050 #1a1a1a; }
    .scroll-row::-webkit-scrollbar { height: 4px; }
    .scroll-row::-webkit-scrollbar-thumb { background: #505050; border-radius: 8px; }
    .card-placeholder { flex: 0 0 140px; height: 200px; background: #1f1f1f; border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.5); transition: transform 0.15s, box-shadow 0.15s; cursor: pointer; }
    .card-placeholder:active { transform: scale(0.98); box-shadow: 0 2px 4px rgba(0,0,0,0.7); }
    @media (min-width: 480px) { .card-placeholder { flex-basis: 160px; height: 220px; } }
    .search-input-wrapper { background: #1e1e1e; border-radius: 30px; padding: 4px 20px; margin: 20px 0 28px; display: flex; align-items: center; border: 1px solid #2c2c2c; }
    .search-input-wrapper i { color: #909090; margin-right: 12px; }
    #searchField { background: transparent; border: none; padding: 14px 0; color: white; font-size: 1rem; width: 100%; outline: none; }
    #searchField::placeholder { color: #6c6c6c; font-weight: 300; }
    .categories-grid { display: flex; flex-wrap: wrap; gap: 12px; margin-top: 12px; }
    .category-chip { background: #1c1c1c; padding: 10px 18px; border-radius: 30px; font-size: 0.9rem; color: #e0e0e0; transition: background 0.15s, color 0.15s; border: none; cursor: pointer; }
    .category-chip:active { background: #e50914; color: white; }
    .empty-placeholder { background: #181818; border-radius: 20px; padding: 40px 24px; text-align: center; color: #9a9a9a; margin: 32px 0; border: 1px dashed #3a3a3a; }
    .empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 70vh; text-align: center; padding: 24px; }
    .empty-icon { font-size: 3.2rem; color: #424242; margin-bottom: 20px; }
    .btn-google { background: #e50914; border: none; color: white; font-size: 1rem; font-weight: 600; padding: 14px 30px; border-radius: 40px; margin-top: 24px; display: inline-flex; align-items: center; gap: 12px; box-shadow: 0 6px 12px rgba(229,9,20,0.2); transition: all 0.18s; border: none; cursor: pointer; }
    .btn-google:active { background: #b20710; transform: scale(0.96); }
    .btn-later { background: transparent; border: 1px solid #5a5a5a; color: #ddd; padding: 12px 28px; border-radius: 40px; font-weight: 500; margin-left: 12px; cursor: pointer; }
    .profile-guest { background: #141414; padding: 32px 20px; border-radius: 24px; text-align: center; max-width: 360px; margin: 40px auto; transition: 0.2s; }
    .profile-icon { font-size: 4rem; color: #6a6a6a; margin-bottom: 16px; }
    .profile-avatar { width: 80px; height: 80px; border-radius: 50%; margin-bottom: 16px; border: 3px solid #e50914; object-fit: cover; }
    .detail-poster-block { width: 100%; height: 220px; background: #1e1e1e; border-radius: 20px; margin: 16px 0 20px; }
    .title-block { height: 28px; width: 70%; background: #2a2a2a; border-radius: 8px; margin: 20px 0 16px; }
    .desc-line { height: 14px; background: #252525; border-radius: 6px; margin-bottom: 10px; }
    .button-row { display: flex; gap: 16px; margin: 32px 0 20px; }
    .disabled-btn { background: #2c2c2c; color: #8a8a8a; padding: 14px 24px; border-radius: 30px; font-size: 1rem; font-weight: 500; border: none; opacity: 0.7; cursor: pointer; }
    .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: #0c0c0c; display: flex; justify-content: space-around; align-items: center; padding: 12px 8px 18px; border-top: 1px solid #222; backdrop-filter: blur(10px); z-index: 1000; }
    .nav-item { display: flex; flex-direction: column; align-items: center; gap: 6px; color: #909090; font-size: 0.75rem; background: transparent; border: none; padding: 6px 12px; border-radius: 12px; transition: color 0.1s, background 0.1s; cursor: pointer; }
    .nav-item i { font-size: 1.3rem; }
    .nav-item.active { color: #e50914; }
    .nav-item:active { background: rgba(229,9,20,0.1); }
    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); display: none; justify-content: center; align-items: flex-end; z-index: 2000; transition: 0.2s; }
    .modal-overlay.active { display: flex; }
    .login-sheet { background: #1a1a1a; width: 100%; border-radius: 28px 28px 0 0; padding: 36px 24px 32px; text-align: center; animation: slideUp 0.25s ease; }
    @keyframes slideUp { from { transform: translateY(20px); opacity: 0.7; } to { transform: translateY(0); opacity: 1; } }
    .login-sheet h3 { font-size: 1.5rem; margin-bottom: 10px; }
    .login-sheet p { color: #b8b8b8; margin-bottom: 28px; }
    .button-group { display: flex; flex-wrap: wrap; justify-content: center; gap: 16px; }
    .d-none { display: none !important; }
    .bottom-nav .nav-item.active i, .bottom-nav .nav-item.active span { color: #e50914; }
    .btn-google i { color: white; }
    .profile-user-name { font-size: 1.8rem; font-weight: 600; margin-bottom: 4px; }
    .profile-user-email { color: #b0b0b0; margin-bottom: 20px; }
  </style>
</head>
<body>
  <!-- ============ FIREBASE SDK ============ -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <script>
    // Firebase configuration – your exact config
    const firebaseConfig = {
      apiKey: "AIzaSyAwTb4dwTnLNwUZ_v37ht4xLL_buNOe96Q",
      authDomain: "mymovieapp-b088c.firebaseapp.com",
      projectId: "mymovieapp-b088c",
      storageBucket: "mymovieapp-b088c.firebasestorage.app",
      messagingSenderId: "243642474836",
      appId: "1:243642474836:web:69071fcd8b2ec9bd97a8c1"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const provider = new firebase.auth.GoogleAuthProvider(); // Google Auth Provider
    console.log("Firebase ready – Google Auth Provider active");
  </script>

  <!-- ============ SCREENS ============ -->
  <!-- HOME SCREEN -->
  <div id="homeScreen" class="screen active">
    <div class="app-header">
      <span class="logo">MOVIESTREAM</span>
      <i class="fas fa-search icon-btn" onclick="switchScreen('searchScreen');"></i>
    </div>
    <div class="banner-container">
      <div id="bannerSlot" class="banner-placeholder">Featured banner will appear here</div>
      <div class="dot-indicator" id="bannerDots">
        <span class="dot active-dot"></span><span class="dot"></span><span class="dot"></span>
      </div>
    </div>
    <!-- 9 content rows (exact order) -->
    <div class="row-section"><div class="row-header"><span class="row-title">Continue Watching</span></div><div class="scroll-row" id="row1"></div></div>
    <div class="row-section"><div class="row-header"><span class="row-title">Trending Now</span></div><div class="scroll-row" id="row2"></div></div>
    <div class="row-section"><div class="row-header"><span class="row-title">New Releases</span></div><div class="scroll-row" id="row3"></div></div>
    <div class="row-section"><div class="row-header"><span class="row-title">Popular Movies</span></div><div class="scroll-row" id="row4"></div></div>
    <div class="row-section"><div class="row-header"><span class="row-title">Top Rated</span></div><div class="scroll-row" id="row5"></div></div>
    <div class="row-section"><div class="row-header"><span class="row-title">Action Movies</span></div><div class="scroll-row" id="row6"></div></div>
    <div class="row-section"><div class="row-header"><span class="row-title">Drama Movies</span></div><div class="scroll-row" id="row7"></div></div>
    <div class="row-section"><div class="row-header"><span class="row-title">Comedy Movies</span></div><div class="scroll-row" id="row8"></div></div>
    <div class="row-section"><div class="row-header"><span class="row-title">Horror Movies</span></div><div class="scroll-row" id="row9"></div></div>
  </div>

  <!-- SEARCH SCREEN -->
  <div id="searchScreen" class="screen">
    <div class="app-header">
      <span class="logo" style="font-size:1.6rem;">Search</span>
      <i class="fas fa-arrow-left icon-btn" onclick="switchScreen('homeScreen');"></i>
    </div>
    <div class="search-input-wrapper">
      <i class="fas fa-search"></i>
      <input type="text" id="searchField" placeholder="Search movies, series, or genres">
    </div>
    <div style="margin-bottom: 12px;"><span class="text-muted">Popular categories</span></div>
    <div class="categories-grid">
      <span class="category-chip" onclick="showEmptySearchResult('Action')">Action</span>
      <span class="category-chip" onclick="showEmptySearchResult('Drama')">Drama</span>
      <span class="category-chip" onclick="showEmptySearchResult('Comedy')">Comedy</span>
      <span class="category-chip" onclick="showEmptySearchResult('Horror')">Horror</span>
      <span class="category-chip" onclick="showEmptySearchResult('Romance')">Romance</span>
      <span class="category-chip" onclick="showEmptySearchResult('Thriller')">Thriller</span>
      <span class="category-chip" onclick="showEmptySearchResult('Sci-Fi')">Sci-Fi</span>
      <span class="category-chip" onclick="showEmptySearchResult('Animation')">Animation</span>
      <span class="category-chip" onclick="showEmptySearchResult('Kids')">Kids</span>
    </div>
    <div id="searchResultPlaceholder" class="empty-placeholder" style="display: none;">
      <i class="fas fa-film" style="font-size:2rem; margin-bottom: 12px; color:#505050;"></i>
      <p id="emptyResultText">Movies will appear here</p>
    </div>
  </div>

  <!-- MY LIST SCREEN (dynamic – shows either guest or logged-in user state) -->
  <div id="myListScreen" class="screen">
    <div class="app-header">
      <span class="logo" style="font-size:1.6rem;">My List</span>
      <i class="fas fa-arrow-left icon-btn" onclick="switchScreen('homeScreen');"></i>
    </div>
    <!-- Content will be populated by JS based on auth state -->
    <div id="myListContent"></div>
  </div>

  <!-- PROFILE SCREEN (dynamic – shows guest or user info) -->
  <div id="profileScreen" class="screen">
    <div class="app-header">
      <span class="logo" style="font-size:1.6rem;">Profile</span>
      <i class="fas fa-arrow-left icon-btn" onclick="switchScreen('homeScreen');"></i>
    </div>
    <div id="profileContent"></div>
  </div>

  <!-- MOVIE DETAIL PLACEHOLDER SCREEN -->
  <div id="detailScreen" class="screen">
    <div class="app-header">
      <span class="logo" style="font-size:1.6rem;">Preview</span>
      <i class="fas fa-arrow-left icon-btn" onclick="switchScreen('homeScreen');"></i>
    </div>
    <div class="detail-poster-block"></div>
    <div class="title-block"></div>
    <div class="desc-line" style="width:100%;"></div>
    <div class="desc-line" style="width:80%;"></div>
    <div class="desc-line" style="width:60%;"></div>
    <div class="button-row">
      <button class="disabled-btn" onclick="handleProtectedAction('play')"><i class="fas fa-play"></i> Play</button>
      <button class="disabled-btn" onclick="handleProtectedAction('add')"><i class="fas fa-plus"></i> My List</button>
      <button class="disabled-btn" onclick="handleProtectedAction('like')"><i class="fas fa-heart"></i> Like</button>
    </div>
    <div style="margin-top: 20px; color: #777; text-align: center; padding: 20px;">
      <i class="fas fa-info-circle"></i> Movie details will appear here
    </div>
  </div>

  <!-- BOTTOM NAVIGATION -->
  <div class="bottom-nav">
    <button class="nav-item active" id="navHome" onclick="switchScreen('homeScreen');"><i class="fas fa-home"></i><span>Home</span></button>
    <button class="nav-item" id="navSearch" onclick="switchScreen('searchScreen');"><i class="fas fa-search"></i><span>Search</span></button>
    <button class="nav-item" id="navMyList" onclick="switchScreen('myListScreen');"><i class="fas fa-list"></i><span>My List</span></button>
    <button class="nav-item" id="navProfile" onclick="switchScreen('profileScreen');"><i class="fas fa-user"></i><span>Profile</span></button>
  </div>

  <!-- LOGIN MODAL (bottom sheet) – used only when protected action triggered -->
  <div id="loginModal" class="modal-overlay">
    <div class="login-sheet">
      <i class="fas fa-user-lock" style="font-size: 2.5rem; color: #e50914; margin-bottom: 8px;"></i>
      <h3>Sign in to continue</h3>
      <p style="font-size: 1rem;">You need an account to save, like or add items.</p>
      <div class="button-group">
        <button class="btn-google" id="googleSignInBtn">
          <i class="fab fa-google"></i> Continue with Google
        </button>
        <button class="btn-later" onclick="closeLoginModal()">Later</button>
      </div>
    </div>
  </div>

  <script>
    // ==================== GLOBAL STATE & UI LOGIC ====================
    let currentUser = null; // will hold Firebase user object

    // ----- SCREEN NAVIGATION -----
    const screens = ['homeScreen', 'searchScreen', 'myListScreen', 'profileScreen', 'detailScreen'];
    const navItems = ['navHome', 'navSearch', 'navMyList', 'navProfile'];

    function switchScreen(screenId) {
      screens.forEach(id => document.getElementById(id).classList.remove('active'));
      document.getElementById(screenId).classList.add('active');
      if (screenId === 'homeScreen') setActiveNav('navHome');
      else if (screenId === 'searchScreen') setActiveNav('navSearch');
      else if (screenId === 'myListScreen') setActiveNav('navMyList');
      else if (screenId === 'profileScreen') setActiveNav('navProfile');
      else setActiveNav(null);
      
      // Refresh My List & Profile content when switching to them (reflect login state)
      if (screenId === 'myListScreen') renderMyListScreen();
      if (screenId === 'profileScreen') renderProfileScreen();
    }

    function setActiveNav(activeId) {
      navItems.forEach(id => document.getElementById(id)?.classList.remove('active'));
      if (activeId) document.getElementById(activeId)?.classList.add('active');
    }

    // ----- POPULATE ROWS WITH GREY CARD PLACEHOLDERS (no movie titles) -----
    const rows = ['row1','row2','row3','row4','row5','row6','row7','row8','row9'];
    rows.forEach(rowId => {
      const container = document.getElementById(rowId);
      if (container) {
        for (let i = 0; i < 10; i++) {
          const card = document.createElement('div');
          card.className = 'card-placeholder';
          card.addEventListener('click', () => switchScreen('detailScreen'));
          container.appendChild(card);
        }
      }
    });

    // ----- AUTO BANNER (calm animation) -----
    let bannerIndex = 0;
    const bannerEl = document.getElementById('bannerSlot');
    const dots = document.querySelectorAll('.dot');
    const bannerMessages = ['Featured banner will appear here', 'Cinematic spotlight · placeholder', 'Now streaming · UI skeleton'];
    function updateBanner() {
      bannerEl.innerText = bannerMessages[bannerIndex];
      dots.forEach((dot, i) => dot.classList.toggle('active-dot', i === bannerIndex));
      bannerIndex = (bannerIndex + 1) % bannerMessages.length;
    }
    setInterval(updateBanner, 3800);
    updateBanner();

    // ----- SEARCH EMPTY STATE -----
    window.showEmptySearchResult = function(category) {
      const placeholderDiv = document.getElementById('searchResultPlaceholder');
      document.getElementById('emptyResultText').innerText = `"${category}" · Movies will appear here`;
      placeholderDiv.style.display = 'block';
    };
    document.getElementById('searchField')?.addEventListener('input', function(e) {
      const placeholder = document.getElementById('searchResultPlaceholder');
      if (e.target.value.length > 0) {
        placeholder.style.display = 'block';
        document.getElementById('emptyResultText').innerText = `Results for "${e.target.value}" will appear here`;
      } else {
        placeholder.style.display = 'none';
      }
    });

    // ============ FIREBASE AUTH – GOOGLE POPUP ============
    const modal = document.getElementById('loginModal');

    // expose close function
    window.closeLoginModal = function() { modal.classList.remove('active'); };

    // Protected action handler (Play, Add, Like, My List button, etc.)
    window.handleProtectedAction = function(action) {
      if (!currentUser) {
        // No user logged in → show login modal
        modal.classList.add('active');
      } else {
        // Logged in: UI-only feedback (no real action)
        alert(`[Signed in as ${currentUser.displayName || currentUser.email}] ${action} action – UI demo`);
      }
    };

    // OVERRIDE: all 'Continue with Google' buttons should trigger real Firebase signInWithPopup
    // We'll attach a single, unified handler
    async function signInWithGoogle() {
      try {
        const result = await auth.signInWithPopup(provider);
        // Success – user logged in
        currentUser = result.user;
        console.log('Login success:', currentUser.displayName, currentUser.email);
        
        // Close modal if open
        closeLoginModal();
        
        // Update UI everywhere
        renderMyListScreen();
        renderProfileScreen();
        
        // Optional: alert welcome
        // alert(`Welcome ${currentUser.displayName || 'User'}!`);
      } catch (error) {
        console.error('Google Sign-In error:', error);
        alert('Sign-in failed. Please try again.');
      }
    }

    // Attach signInWithGoogle to the modal's Google button (by ID)
    document.getElementById('googleSignInBtn').addEventListener('click', (e) => {
      e.preventDefault();
      signInWithGoogle();
    });

    // Also attach to any .btn-google that appears dynamically (My List, Profile guest buttons)
    // We'll use event delegation or re-attach on render. Use a global listener.
    document.body.addEventListener('click', function(e) {
      const btn = e.target.closest('.btn-google');
      if (btn && btn.id !== 'googleSignInBtn') { // avoid double trigger on modal button
        e.preventDefault();
        // If it's inside MyList or Profile guest section, open modal or direct signin?
        // For better UX: trigger signIn directly (no modal) – consistent.
        if (!currentUser) {
          signInWithGoogle();
        } else {
          // already logged in: maybe show message
          alert('You are already signed in.');
        }
      }
    });

    // ----- AUTH STATE CHANGE (fires on load, login, logout) -----
    auth.onAuthStateChanged((user) => {
      currentUser = user;
      if (user) {
        console.log('Auth state: logged in as', user.displayName);
      } else {
        console.log('Auth state: guest');
      }
      // Refresh screens that depend on auth state
      renderMyListScreen();
      renderProfileScreen();
    });

    // ============ RENDER MY LIST (guest / user) ============
    function renderMyListScreen() {
      const container = document.getElementById('myListContent');
      if (!container) return;

      if (!currentUser) {
        // GUEST STATE – empty + google button
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon"><i class="fas fa-bookmark"></i></div>
            <h3 style="font-weight: 400; margin-bottom: 12px;">Your saved movies will appear here</h3>
            <button class="btn-google"><i class="fab fa-google"></i> Continue with Google</button>
          </div>
        `;
      } else {
        // LOGGED IN – but no saved items (placeholder)
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon"><i class="fas fa-list"></i></div>
            <h3 style="font-weight: 400; margin-bottom: 8px;">Your list is empty</h3>
            <p class="text-muted" style="margin-bottom: 16px;">Movies you save will appear here</p>
            <button class="btn-google" style="background: #2a2a2a; box-shadow: none;" onclick="switchScreen('homeScreen')">
              <i class="fas fa-compass"></i> Browse Movies
            </button>
          </div>
        `;
      }
    }

    // ============ RENDER PROFILE (with name, photo, email) ============
    function renderProfileScreen() {
      const container = document.getElementById('profileContent');
      if (!container) return;

      if (!currentUser) {
        // GUEST MODE
        container.innerHTML = `
          <div class="profile-guest">
            <div class="profile-icon"><i class="fas fa-user-circle"></i></div>
            <h2 style="font-size:1.6rem; margin-bottom: 8px;">Guest</h2>
            <p class="text-muted" style="margin-bottom: 16px;">You are browsing as a Guest</p>
            <p style="margin-bottom: 28px; color:#b0b0b0;">Login to save movies, likes, and watch history</p>
            <button class="btn-google"><i class="fab fa-google"></i> Continue with Google</button>
          </div>
        `;
      } else {
        // LOGGED IN USER – show name, email, profile picture
        const photoURL = currentUser.photoURL || '';
        const displayName = currentUser.displayName || 'User';
        const email = currentUser.email || '';

        container.innerHTML = `
          <div class="profile-guest" style="padding: 32px 20px;">
            ${photoURL ? 
              `<img src="${photoURL}" alt="avatar" class="profile-avatar">` : 
              `<div class="profile-icon"><i class="fas fa-user-circle"></i></div>`
            }
            <h2 class="profile-user-name">${displayName}</h2>
            <p class="profile-user-email">${email}</p>
            <p style="margin-bottom: 20px; color: #b0b0b0;">You're signed in</p>
            <button class="btn-google" style="background: #2a2a2a; border:1px solid #555;" id="signOutBtn">
              <i class="fas fa-sign-out-alt"></i> Sign Out
            </button>
          </div>
        `;

        // Attach sign out handler
        const signOutBtn = document.getElementById('signOutBtn');
        if (signOutBtn) {
          signOutBtn.addEventListener('click', async () => {
            try {
              await auth.signOut();
              // Auth state change will re-render
            } catch (err) {
              console.error('Sign out error', err);
            }
          });
        }
      }
    }

    // ============ INITIAL RENDER ============
    renderMyListScreen();
    renderProfileScreen();

    // Modal backdrop click to close
    modal.addEventListener('click', function(e) {
      if (e.target === modal) closeLoginModal();
    });

    // Additional: handle "Play/Add/Like" – we already use handleProtectedAction
    window.openLoginModal = function() { modal.classList.add('active'); }; // legacy, but we use handleProtectedAction

    // For any inline onclick="openLoginModal(...)" we override to use protected handler.
    // We already replaced buttons in detail screen with handleProtectedAction.
    // Also My List/Profile buttons now use the global .btn-google delegation.
    console.log('Firebase Google Auth integrated – ready to sign in.');
  </script>

  <!-- ensure signout not breaking -->
  <style>
    .profile-avatar { width: 80px; height: 80px; border-radius: 50%; margin-bottom: 16px; border: 3px solid #e50914; object-fit: cover; }
  </style>
</body>
</html>
